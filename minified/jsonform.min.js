/* jsonform.js */
/*
 Copyright Milfont Consulting.
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(l){l.fn.extend({version:"1.2.5",getJSON:function(e){var b={},a=this,c;"object"===typeof e&&(c=e,e=c.byId?c.byId:!1);a.find("input,textarea,select").each(function(d,f){if("radio"!=f.type||f.checked){var n=e?l.trim(f.id):l.trim(f.name),h="select-multiple"===f.type?l(f).val():f.value;""!==n&&("checkbox"==f.type&&(h=f.checked?!0:!1),a.merge(b,a.buildJson(n,h,c)))}});return b},populate:function(e,b){var a=function(a){return a.every(function(a){return"object"!=typeof a})},c=this;(function f(n,
h){for(var p in n)if(n[p]||0===n[p]){var g=n[p];if("object"!=typeof g||l.isArray(g)&&a(g)){var m=h?h+"\\."+p:p,k="[name='"+m+"']";b&&(k="#"+m);var e=c.find(k);0===e.length&&(k=k.replace(/\\\[(\d+)?\\\]/g,"\\[\\]"),m=m.replace(/[^\\\[(\d+)?\\\]]/g,"").replace(/[^\d+]/g,""),e=c.find(k).eq(m));e.val(g)}else if(m=h?h+"\\."+p:p,l.isArray(g))for(var q in g)g[q]&&f(g[q],m+"\\["+q+"\\]");else f(g,m)}})(e);return this},buildJson:function(e,b,a){var c=a&&a.prefix?a.prefix:"",d=a&&a.suffix?a.suffix:"",f=function(a,
b){var c=a.match(/\[(\d?)\]/);if(c){var g=[],d=0;""!==c[1].trim()&&(d=c[1]);g[d]=b;return g}return b};return function h(a,b,e){b=b.split(".");var k=b.shift();a[c+k.replace(/\[(\d?)\]/,"")+d]=0<b.length?f(k,h({},b.join("."),e)):f(k,e);return a}({},e,b)},merge:function b(a,c){for(var d in c)"object"===typeof c[d]&&"undefined"!==typeof a[d]?l.isArray(a[d])&&l.isArray(c[d])&&!Object.Equals(a[d],c[d].clean())?a[d].push(c[d][0]):b(a[d],c[d]):a[d]=c[d];return a}});Object.Equals=Object.Equals||function(b,
a){return JSON.stringify(b)===JSON.stringify(a)};Array.prototype.clean=function(){for(var b=0;b<this.length;b++)if(null===this[b]||void 0===this[b])this.splice(b,1),b--;return this}})(jQuery);